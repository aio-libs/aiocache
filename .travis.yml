language: python

python:
- '3.5'
- '3.6'

before_install:
- sudo apt-get install apache2-utils

install:
- pip install -r requirements-ci.txt

script:
- make syntax
- python setup.py develop
- pytest --cov-report term-missing --cov=aiocache -sv tests/ut
- pytest -sv tests/acceptance
- bash examples/run_all.sh

services:
- redis-server
- memcached

after_success:
- codecov

deploy:
  password:
    secure: lRAkrxFqkQ4i60iV/x49sDYwT5NYtVi9WF3xaBga1XSI7SGDheWXHj1N2GPABy1nSozzYbB6iDb8Q0tSxibcQAu1senqK3unx5czf34ec7ndhbAucfWTOYCKdM7anIs+kEDBT3lXysC7+5iph71YewaGXzoa4WvSanlcdFwcOdyJ6o2f0FgGw795t/+Gt0xcra7vcjjXbvovTgOs+6yilx8XEpCcQrvz96LKY5h88+Cx1crlTCXGNYLf8oAgzddrMHTqMHNSVVIX6hmvkFYkm2QWTChRD3+QZD//zfUViIkN0YTQAveoDy3nWtrMOVi50nr3cu5Ee/VH8agOs75pgBsfsrxNajCDjMsanB8Kxi3EISW6pBkh6NjjC89LaCEJ61uxG/5lkdK5r9Gb41AU7I7zmIPH8HI6y1bFbkbiJKR1vXb2jccjJGLJF5i7khrS4z64snxSFRBwMEMCbtfVSRL954OkMvIN8VtsZ/bWQy4YGlPKdJ0rmB8FhdhxSTPZNiC7XwDobJmEeFAOfrnfxvhvGGXjMmed0A3LlrEngGC5vamh/lyJ6ZizNpPzrY3z/m1vkdgCcvmoIYb9tmAS+YN+8LGB/MdoNAuq9Ah+ScXENgCoD4bDOunLE1XC6rYYiJp0mjm+4W/fI54m7KViVOcw60P68r/LmplB36vteQ8=
  distributions: "sdist"
  on:
    tags: true
